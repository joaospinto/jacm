\section{Introduction}

Reachability problems are a staple of theoretical computer
science and verification, one of the best-known examples being the
Halting Problem for Turing machines. In this paper, our motivation
originates from systems that evolve continuously subject to linear
differential equations; such objects arise in the analysis of a range
of models, including linear hybrid automata, continuous-time Markov
chains, linear dynamical systems and cyber-physical systems as they
are used in the physical sciences and engineering---see,
e.g.,~\cite{Alu15}.

More precisely, consider a system consisting of a finite number of
discrete locations (or control states), having the property that the
continuous variables of interest evolve in each location according to
some linear differential equation of the form $\dot{\myvector{x}} = A
\myvector{x}$; here $\myvector{x}$ is a vector of continuous
variables, and $A$ is a square `rate' matrix of appropriate
dimension.\footnote{In
  this motivating example, we assume that there are no discrete
  resets of the continuous variables when transitioning between
  locations.}
As is well-known, in each location the closed form solution
$\myvector{x}(t)$ to the differential equation admits a
matrix-exponential representation of the form $\myvector{x}(t) =
\exp(At)\myvector{x}(0)$. Thus if a system evolves through a series
of $k$ locations, each with rate matrix $A_i$, and spending time $t_i
\geq 0$ in each location, the overall effect on the initial
configuration $\myvector{x}(0)$ is determined by multiplying by the matrix
\begin{align*}
\prod \limits_{i=1}^{k} \exp(A_{i} t_{i}) \, .
\end{align*}

A particularly interesting situation arises when the matrices $A_i$
commute; in such cases, one can show that the order in which the
locations are visited (or indeed whether they are visited only once or
several times) is immaterial, the only relevant data being the total
time spent in each location. Natural questions then arise as to what
kinds of linear transformations can thus be achieved by such systems.

The main object of study of this paper will be the following decision problem:
\begin{restatable}{definition}{MESP}
\label{def:MESP}
Given square matrices $A_{1}, \ldots, A_{k}$ and $C$, all of the same
dimension, whose entries are real algebraic numbers, the
\emph{Matrix-Exponential Semigroup Problem} (MESP) asks
whether $C$ a is member of the matrix semigroup generated by
\begin{align*}
    \lbrace \exp(A_{i} t_{i}) : t_{i} \in \Reals, t_{i} \geq 0, i=1,\ldots,k \rbrace.
\end{align*}
\end{restatable}
We will show that MESP is undecidable in general, but decidable when the matrices $A_{1}, \ldots, A_{k}$ commute.
This answers the problem we left open in~\cite{LICS16}.

\subsection{Related Work}
\label{sec:lics_related_work}

In this section, we describe a few decision problems that can be seen as discrete-time analogues of the questions we deal with in this paper.

Given $k+1$ square matrices $A_{1}, \ldots, A_{k}, C$, all of the same dimension, and with algebraic entries, the \emph{Matrix Semigroup Membership Problem} consists in deciding whether the matrix $C$ belongs to the multiplicative semigroup generated by $A_{1}, \ldots, A_{k}$.
On the other hand, given the multiplicative matrix equation
\begin{align*}
\prod\limits_{i=1}^{k} A_{i}^{n_{i}} = C \, ,
\end{align*}
one may be interested in determining whether it admits a solution $n_{1}, \ldots, n_{k} \in \Naturals$.

In general, both problems have been shown to be undecidable, in~\cite{Paterson} and~\cite{MEHTP}.
When the matrices $A_{1}, \ldots, A_{k}$ commute, the two problems are
equivalent, and known to be decidable~\cite{MultiplicativeMatrixEquations}.

Prior to~\cite{MultiplicativeMatrixEquations}, the case $k=1$ was shown to be decidable in~\cite{KL86} and the case $k=2$ was shown to be decidable in~\cite{ABC}.

See~\cite{HalavaSurvey} for a relevant survey, and~\cite{CK05} for
some interesting related problems.

The following continuous analogue of Kannan and Lipton's Orbit
Problem~\cite{KL86} was shown to be decidable in~\cite{Hainry08}:

\begin{definition}[Continuous Orbit Problem]
Given an $n \times n$ matrix $A$ with algebraic entries and two
$n$-dimensional vectors $\myvector{x}, \myvector{y}$ with
algebraic coordinates, does there exist a non-negative real number $t$ such
that $\exp(At) \myvector{x} = \myvector{y}$?
\end{definition}

The paper~\cite{ContinuousOrbitIPL} simplifies the argument of
\cite{Hainry08} and shows polynomial-time decidability. Moreover, a
continuous version of Skolem's Problem was dealt with in
\cite{ContinuousSkolem}, where a decidability result is presented for
some instances of the problem.

As mentioned earlier, an important motivation for our work comes from
the analysis of hybrid automata. In addition to~\cite{Alu15},
excellent background references on the topic are
\cite{HenzingerSTOC,HenzingerLICS}.

\subsection{Decision Problems}

We start by defining three decision problems that will be central to this paper: the \emph{Matrix-Exponential Problem},
the \emph{Linear-Exponential Problem}, and the
\emph{Algebraic-Logarithmic Integer Programming} problem.
The relation between these problems will be outlined in \cref{sec:lics_outline}, but the reader should keep in mind that our ultimate objective is the study of the \emph{Matrix-Exponential Semigroup Problem}, stated in \cref{def:MESP}.

\begin{definition}
  Given square matrices $A_{1}, \ldots, A_{k}$ and $C$, all of the same
  dimension and with real algebraic entries,
  the \emph{Matrix-Exponential Problem} (MEP) consists in determining
  whether there exist real numbers $t_1,\ldots,t_k \geq 0$ such that
\begin{align}
\label{MEP}
\prod \limits_{i=1}^{k} \exp(A_{i} t_{i}) = C \, .
\end{align}
\label{def:MEP}
\end{definition}

We will also consider a generalised version of this problem, called
the \emph{Generalised MEP}, in which the matrices $A_1,\ldots,A_k$ and
$C$ are allowed to have complex algebraic entries and in which the
input to the problem also mentions a polytope
$\mathcal{P}\subseteq\Reals^{2k}$ that is specified by linear
inequalities with real algebraic coefficients.  In the generalised problem
we seek $t_1,\ldots,t_k \in \Complex$ that satisfy (\ref{MEP}) and
such that the vector
$(\Re(t_1),\ldots,\Re(t_k),
\Im(t_1),\ldots,\Im(t_k))$ lies in $\mathcal{P}$.

In the case of commuting matrices, the Generalised Matrix-Exponential
Problem can be analysed block-wise, as we shall see in \cref{sec:lics_decidability}, leading us to the following
problem:

\begin{definition}
  An instance of the \emph{Linear-Exponential Problem} (LEP) consists of a system
  of equations
\begin{align}
\label{single_eqn_form}
  \exp\left(\sum_{i \in I} \lambda_i^{(j)} t_i \right) = c_j \exp (d_j)
\quad (j \in J),
\end{align}
where $I$ and $J$ are finite index sets, the $\lambda_i^{(j)}$, $c_j$
and $d_j$ are complex algebraic constants, and the $t_i$ are complex
variables, together with a polytope
$\mathcal{P} \subseteq \Reals^{2k}$ that is specified by a system
of linear inequalities with algebraic coefficients.  The problem asks
to determine whether there exist $t_1,\ldots,t_k\in \Complex$ that
satisfy the system (\ref{single_eqn_form}) and such that
$(\Re(t_1),\ldots,\Re(t_k),\Im(t_1),\ldots,\Im(t_k))$
lies in $\mathcal{P}$.
\label{def:LEP}
\end{definition}

To establish decidability of the Linear-Exponential Problem, we reduce
it to the following
\emph{Algebraic-Logarithmic Integer Programming}
problem.  We remind the reader that a \emph{linear form in logarithms of algebraic numbers}
is a number of the form
$\beta_{0} + \beta_{1} \log(\alpha_{1}) + \cdots + \beta_{m}
\log(\alpha_{m})$,
where
$\beta_{0}, \alpha_{1}, \beta_{1}, \ldots, \alpha_{m}, \beta_{m}$ are
algebraic numbers and $\log$ denotes a fixed branch of the complex
logarithm function.

% \exp(\myvector{\lambda} \cdot \myvector{t}) = c_{\myvector{\lambda}} \exp(d_{\myvector{\lambda}}), \quad \myvector{\lambda} \in \Algebraics^{n}, c_{\myvector{\lambda}}, d_{\myvector{\lambda}} \in \Algebraics
% \end{align}
% and a convex polytope $\mathcal{P} \subseteq \Reals^{2k}$ with an algebraic description, decide whether (\ref{single_eqn_form}) admits a solution $\myvector{t}$ such that $(\Re(\myvector{t}), \Im(\myvector{t})) \in \mathcal{P}$.
% \end{definition}

% In both cases, when a constraint of the form $(\Re(\myvector{t}), \Im(\myvector{t})) \in \mathcal{P}$ is imposed, where $\mathcal{P} \subseteq \Reals^{2k}$ is a convex polytope with an algebraic description, we refer to the problem as the \emph{constrained MEP/LEP}; the predicates defined above may often be combined, e.g. \emph{constrained commuting MEP}.

\begin{definition}
An instance of the \emph{Algebraic-Logarithmic Integer Programming Problem} (ALIP) consists of a finite system of equations of the form
\begin{align*}
A \myvector{x} \leq \frac{1}{\pi} \myvector{b},
\end{align*}
where $A$ is an $m\times n$ matrix with real algebraic entries and
where the coordinates of $\myvector{b}$ are real linear forms in
logarithms of algebraic numbers. The problem asks to determine whether
such a system admits a solution $\myvector{x} \in \Integers^{n}$.
\end{definition}

We will also be interested in the following two problems, which will be shown to be undecidable by reduction from MESP\@.

\begin{restatable}{definition}{generalisedproblems}
\label{def:generalised-problems}
Given square matrices $A_{1}, \ldots, A_{k}$ and vectors $\myvector{x}, \myvector{y}$ whose entries are real algebraic numbers and of matching dimensions, the \emph{Generalised Continuous Orbit Problem} (GCOP) consists in deciding whether there exists a matrix $C$ in the multiplicative matrix semigroup generated by the set $\lbrace \exp(A_{i} t_{i}), t_{i} \geq 0, i = 1, \ldots, k \rbrace$ such that $C\myvector{x} = \myvector{y}$. On the other hand, the \emph{Generalised Continuous Skolem Problem} (GCSP) asks whether there exists such a matrix $C$ so that $\myvector{x}^{T} C \myvector{y} = 0$.
\end{restatable}

Finally, we revisit the statement of MESP, as MESP is the ultimate object of our analysis.
Note that this can be seen as a continuous analogue of the matrix semigroup membership problem, introduced in \cref{sec:lics_related_work}.

\MESP*

\subsection{Paper Outline}
\label{sec:lics_outline}

To help the reader navigate through this paper, we provide a brief schematic outline of the results/reductions herein. Our undecidability result will be established by the following chain of reductions (where HTP refers to Hilbert's Tenth Problem):

\begin{equation*}
\mbox{HTP} \leq \mbox{MEP} \leq \mbox{MESP} \leq \mbox{GCOP} \leq \mbox{GCSP} \, .
\end{equation*}

On the other hand, the decidability result in the commutative setting will be established by proving that $\mbox{ALIP}$ is decidable and by the following chain of reductions:

\begin{equation*}
\mbox{Generalised MEP} \leq \mbox{LEP} \leq \mbox{ALIP} \, .
\end{equation*}

Before proceeding, however, we include some background material that will help the reader getting acquainted with some of the tools that will be deployed later on in this paper.

%We present a reduction from the Generalised Matrix Exponential Problem with commuting matrices to the Linear-Exponential Problem, as well as a reduction from the Linear-Exponential Problem to the Algebraic-Logarithmic Integer Programming Problem, before finally showing that the Algebraic-Logarithmic Integer Programming Problem is decidable. By way of hardness, we will prove that the Matrix-Exponential Problem is undecidable (in the non-commutative case), by reduction from Hilbert's Tenth Problem. We will then show how to encode the Matrix-Exponential Problem in the Matrix-Exponential Semigroup Problem, thereby showing that the latter problem is undecidable. Finally, we will reduce the Matrix-Exponential Semigroup Problem to the Generalised Continuous Orbit Problem, and then reduce the Generalised Continuous Orbit Problem to the Generalised Continuous Skolem Problem, which implies that these are both also undecidable.
%By contrast, note that the Continuous Orbit Problem is known to be decidable (see~\cite{ContinuousOrbitIPL}), and that there are also a number of partial decidability results known for the Continuous Skolem Problem (although some of these are conditional on Schanuel's Conjecture being true; see~\cite{ContinuousSkolem3}).
