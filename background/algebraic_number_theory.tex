\subsection{Algebraic Number Theory}
\label{sec:ant}

In this subsection, we introduce the main concepts in algebraic number theory necessary for understanding the hypothesis of the $S$-units theorem, stated below. In a later subsection, we shall justify the application of the aforementioned result in lower-bounding the dominant terms of linear recurrence sequences. We also briefly explain how one can effectively manipulate algebraic numbers. Should the reader be seeking an in-depth course in computational algebraic number theory, they can consult~\cite{Cohen}.

A complex number $\alpha$ is said to be \emph{algebraic} if it is a zero of some non-zero polynomial with integer coefficients. Among those polynomials, there exists a unique one of minimal degree whose coefficients have no common factor and whose leading coefficient is positive, and it is said to be the \emph{defining polynomial} of $\alpha$, denoted by $p_{\alpha}$, and it is always an irreducible polynomial. Moreover, if $p_{\alpha}$ is monic, $\alpha$ is said to be an \emph{algebraic
integer}. The degree of an algebraic number is defined as the degree of $p_{\alpha}$, and its height as the maximum absolute value of the coefficients of $p_{\alpha}$ (also said to be the height of that polynomial). The zeros of $p_{\alpha}$ are said to be the \emph{Galois conjugates} of $\alpha$. Note that the complex conjugate of $\alpha$ is always a Galois conjugate of $\alpha$.
We denote the set of algebraic numbers by $\Algebraics$, and the set of algebraic integers by $\mathcal{O}$. For all $\alpha \in \Algebraics$, there exists some $n\in\Naturals$ such that $n \alpha \in \mathcal{O}$. It is well known that $\Algebraics$ is a field and that $\mathcal{O}$ is a ring. A complex number that is not algebraic is said to be \emph{transcendental}.

A \emph{number field} of dimension $d$ is a field extension $K$ of $\Rationals$ whose degree as a vector-space over $\Rationals$ is $d$. In particular, $K\subseteq\Algebraics$ must hold.
Recall that, in that case, there are exactly $d$ monomorphisms $\sigma_{i} : K \rightarrow \Complex$ whose restriction over $\Rationals$ is the identity (and therefore these must map elements of $K$ to their Galois conjugates).
Given an algebraic number $\alpha$, $\Rationals(\alpha)$ denotes the smallest number field containing $\alpha$. Moreover, if $K=\Rationals(\alpha)$, then $\alpha$ is said to be a \emph{primitive element} of $K$. It is well known that all number fields have a primitive element.

The \emph{ring of integers} $\mathcal{O}_{K}$ of a number field $K$ is the set of elements of $K$ that are algebraic integers, that is, $\mathcal{O}_{K}=K\cap\mathcal{O}$.
An ideal of $\mathcal{O}_{K}$ is an additive subgroup of $\mathcal{O}_{K}$ that is closed under multiplication by any element of $\mathcal{O}_{K}$. An ideal $\mathfrak{P}$ is said to be prime if $ab\in \mathfrak{P}$ implies $a\in\mathfrak{P}$ or $b\in\mathfrak{P}$. The following theorem is central in Algebraic Number Theory, and a proof can be found in~\cite{SnT}:

\begin{theorem}
In any ring of integers, ideals can be uniquely factored as products of prime ideals up to permutation.
\end{theorem}

The next theorem, by Evertse, van der Poorten, and Schlickewei, was established in~\cite{Evertse84,PS82} to analyse the growth of linear recurrence sequences. It gives a very strong lower bound on the magnitude of sums of $S$-units, as defined below. Its key ingredient is Schlickewei's $p$-adic generalisation~\cite{Sch77} of Schmidt's subspace theorem.

Let $S$ be a finite set of prime ideals of the ring of integers
$\mathcal{O}_{K}$ of a number field $K$. We say that
$\alpha \in \mathcal{O}_{K}$ is an \emph{$S$-unit} if all the ideals
appearing in the prime factorisation of $(\alpha)$, that is, the principal ideal in $\mathcal{O}_{K}$ generated by $\alpha$, are in $S$.

\begin{theorem}[$S$-units]
\label{thm:s-units}
Let $K$ be a number field, $s$ be a positive integer, and $S$ be a
finite set of prime ideals of $\mathcal{O}_{K}$. Then for every
$\varepsilon>0$ there exists a constant $C$, depending only on $s$,
$K$, $S$, and $\varepsilon$, with the following property. For every
set of $S$-units $x_1,\ldots,x_s\in\mathcal{O}_{K}$ such that
$\sum\limits_{i\in I} x_i\neq 0$ for all non-empty $I\subseteq\lbrace 
1,\ldots,s\rbrace$,
\[ \lvert x_1+\cdots+x_s \rvert\geq CYZ^{-\varepsilon} \]
where $Y=\max\lbrace \lvert x_j\rvert : 1\leq j\leq s \rbrace$ and $Z=\max\lbrace \sigma_i(x_j): 1\leq j\leq s,1\leq i\leq d \rbrace$ and $\sigma_i$ represent the different monomorphisms from $K$ to $\Complex$.
\end{theorem}

\subsubsection{Manipulating algebraic numbers}
\label{sec:alg_num_rep}

The following separation bound allows us to effectively represent an arbitrary algebraic number by keeping its defining polynomial, a sufficiently accurate estimate for the zero we want to represent, and an upper bound on the error. We call this its \emph{standard/canonical representation}.

\begin{lemma}[Mignotte]
Let $f\in\Integers[x]$. Then
\begin{equation}
f(\alpha_1)=0=f(\alpha_2)\Rightarrow \lvert \alpha_1-\alpha_2\rvert>\frac{\sqrt{6}}{d^{(d+1)/2}H^{d-1}}
\end{equation}
where $d$ and $H$ are respectively the degree and height of $f$.
\end{lemma}

It is well known that arithmetic operations and equality testing on these caninocal representations can be done in time polynomial on their size, since one can
\begin{itemize}
\item compute polynomially many bits of the zeros of any polynomial $p\in\Rationals[x]$ in polynomial time, due to the work of Pan in~\cite{Pan97};
\item find the defining polynomial of an algebraic number by factoring the polynomial in its description in polynomial time using the LLL algorithm~\cite{LenstraLenstraLovasz1982};
\item use the sub-resultant algorithm (see Algorithm 3.3.7 in~\cite{Cohen}) and the two aforementioned procedures to compute canonical representations of sums, differences, multiplications, and divisions of canonically represented algebraic numbers.
\end{itemize}

Moreover, we need to know how to decide whether a given canonically represented algebraic number $\alpha$ is a root of unity, that is, whether $\alpha^r=1$ for some $r$. If that is the case, then its defining polynomial will be the $r$-th cyclotomic polynomial, which has degree $\phi(r)$, if $r$ is taken to be minimal, that is, if $\alpha$ is a primitive $r$-th root of unity. The following (crude) lower bound on $\phi(r)$ allows us to decide this problem in polynomial time, assuming that the
degree of $\alpha$ is given in unary. It follows from the obvious fact that $\phi(r) \geq \pi(r)$, where $\pi(r)$ denotes the number of prime numbers in the set $\lbrace 1, \ldots, r \rbrace$, and from the fact that $\pi(r) > r / \log(r) > \sqrt{r/2}$ for $r \geq 17$~\cite[Corollary 1]{RS62}. It can be readily verified that the result below also holds for $1 \leq r \leq 16$. Note that much better bounds are known; for example, $\phi(r) = \Omega(r / \log\log(r))$~\cite[Theorem 15]{RS62}.

\begin{lemma}
\label{lem:totient}
Let $\phi$ be Euler's totient function. Then $\phi(r)\geq\sqrt{r/2}$. Therefore, if $\alpha$ has degree $n$ and is a $r$'th root of unity, then $r\leq 2n^2$.
\end{lemma}

Therefore, in order to decide whether an algebraic number $\alpha$ of degree $n$ is a root of unity, we check whether it is a $r$-th root of unity, for each $r\leq 2n^2$. In order to test whether $\alpha$ is a $r$-th root of unity, it suffices to see whether $\gcd(p_\alpha,x^r-1)=p_\alpha$, since we know that $x^r-1$ is the product of each $d$-th cyclotomic polynomial, with $d$ ranging over the divisors of $r$.

\subsubsection{Integral solutions of linear equations with algebraic coefficients}

Consider a non-zero matrix $K\in\Algebraics^{r\times d}$ and vector $\myvector{k} \in \Algebraics^r$.  The following proposition shows how to compute a representation of the set $\lbrace \myvector{x} \in \Integers^{d} : K\myvector{x} = \myvector{k} \rbrace$.

\begin{proposition}
  Let $S = \lbrace \myvector{x}\in\Integers^{d} : K\myvector{x} =
  \myvector{k} \rbrace$. If $S \neq \emptyset$, then there exist
  $\myvector{x}_{0} \in \Integers^{d}$ and $M \in \Integers^{d \times s}$ such that
  $S = \myvector{x}_{0} + \lbrace M \myvector{y} : \myvector{y} \in \Integers^s \rbrace$.
\end{proposition}

\begin{proof}
  Let $\theta$ denote a primitive element of the number field
  generated by the entries of $K$ and $\myvector{k}$. Let the degree of this extension, which equals the degree of $\theta$, be $D$. Then for $\myvector{x} \in \Integers^{d}$ one can write
\begin{align*}
K \myvector{x} = \myvector{k} &\Leftrightarrow \left( \sum \limits_{i=0}^{D-1} N_{i} \theta^{i} \right) \myvector{x} = \sum \limits_{i=0}^{D-1} \myvector{k}_{i} \theta^{i} \\
&\Leftrightarrow N_{i} \myvector{x} = \myvector{k}_{i}, \forall i \in \lbrace 0, \ldots, D-1 \rbrace ,
\end{align*}
for some integer matrices $N_{0}, \ldots, N_{D-1} \in \Integers^{r \times d}$ and integer vectors $\myvector{k}_{0}, \ldots, \myvector{k}_{D-1} \in \Integers^{r}$.
We take $\myvector{x}_{0}$ to be any solution of this system, and select the columns of $M$ to be a minimal set generating
\begin{equation*}
\mathcal{G} = \lbrace \myvector{x} \in \Integers^{d} : \forall i \in \lbrace 0, \ldots, D-1 \rbrace, N_{i} \myvector{x} = \myvector{0} \rbrace \, .
\end{equation*}
Note that, since $\mathcal{G}$ is a subgroup of the finitely generated abelian group $\Integers^{d}$, $\mathcal{G}$ itself must be finitely generated.
\end{proof}
